{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/Programming/NodeJs%20Learning/ecommerce-app/app/products/page.js"],"sourcesContent":["'use client';\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport Link from 'next/link';\r\nimport Image from 'next/image';\r\nimport { useRouter } from 'next/navigation';\r\n\r\nexport default function Products() {\r\n  const [products, setProducts] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState('');\r\n  const [cart, setCart] = useState({});\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    const fetchProducts = async () => {\r\n      try {\r\n        const res = await axios.get('/api/products');\r\n        setProducts(res.data);\r\n      } catch (err) {\r\n        setError(err.response?.data || 'Failed to fetch products.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchProducts();\r\n  }, []);\r\n\r\n  const handleAddToCart = (productId) => {\r\n    setCart(prev => ({\r\n      ...prev,\r\n      [productId]: (prev[productId] || 0) + 1\r\n    }));\r\n  };\r\n\r\n  const handleDeleteProduct = async (productId) => {\r\n    if (!confirm('Are you sure you want to delete this product?')) return;\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n      await axios.delete(`/api/products/${productId}`, {\r\n        headers: { Authorization: token }\r\n      });\r\n      setProducts(products.filter(p => p._id !== productId));\r\n    } catch (err) {\r\n      alert(err.response?.data || 'Failed to delete product.');\r\n    }\r\n  };\r\n\r\n  if (loading) return (\r\n    <div className=\"flex justify-center items-center min-h-[60vh]\">\r\n      <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500\"></div>\r\n    </div>\r\n  );\r\n\r\n  if (error) return (\r\n    <div className=\"max-w-md mx-auto mt-10 p-6 bg-red-50 dark:bg-red-900/20 rounded-lg shadow-md text-center\">\r\n      <p className=\"text-red-600 dark:text-red-400\">{error}</p>\r\n      <button\r\n        onClick={() => window.location.reload()}\r\n        className=\"mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\r\n      >\r\n        Try Again\r\n      </button>\r\n    </div>\r\n  );\r\n\r\n  return (\r\n    <div className=\"container mx-auto p-6\">\r\n      <div className=\"flex justify-between items-center mb-8\">\r\n        <h2 className=\"text-3xl font-bold text-gray-800 dark:text-white\">Our Products</h2>\r\n        <Link href=\"/add-product\" className=\"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors\">\r\n          Add New Product\r\n        </Link>\r\n      </div>\r\n      {products.length === 0 ? (\r\n        <div className=\"text-center p-8 bg-gray-50 dark:bg-gray-800 rounded-lg\">\r\n          <p className=\"text-gray-500 dark:text-gray-400\">No products available.</p>\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6\">\r\n          {products.map((product) => (\r\n            <div key={product._id} className=\"border rounded-lg shadow-lg overflow-hidden bg-white dark:bg-gray-800 hover:shadow-xl transition-shadow\">\r\n              <Link href={`/products/${product._id}`} className=\"block\">\r\n                <div className=\"relative h-64 w-full\"> {/* Increased from h-48 to h-64 */}\r\n                  {product.images && product.images.length > 0 ? (\r\n                    <Image\r\n                      src={product.images.find(img => img.isProminent)?.url || product.images[0].url}\r\n                      alt={product.name}\r\n                      fill\r\n                      className=\"object-cover\"\r\n                    />\r\n                  ) : (\r\n                    <div className=\"w-full h-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center\">\r\n                      <svg className=\"h-12 w-12 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                        <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z\" />\r\n                      </svg>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                <div className=\"p-4\">\r\n                  <h3 className=\"text-lg font-semibold mb-1 text-gray-800 dark:text-white\">{product.name}</h3> {/* Reduced from text-xl to text-lg */}\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300 mb-1\"> {/* Reduced to text-sm */}\r\n                    <span className=\"font-medium\">Price:</span> ${product.price.toFixed(2)}\r\n                  </p>\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-300 mb-2\"> {/* Reduced to text-sm */}\r\n                    <span className=\"font-medium\">Stock:</span> {product.stock}\r\n                  </p>\r\n                </div>\r\n              </Link>\r\n              <div className=\"p-4 flex space-x-2\">\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.preventDefault();\r\n                    handleAddToCart(product._id);\r\n                  }}\r\n                  disabled={product.stock === 0}\r\n                  className={`flex-1 py-2 rounded-lg transition-colors text-sm ${\r\n                    product.stock === 0\r\n                      ? 'bg-gray-400 cursor-not-allowed'\r\n                      : 'bg-blue-600 hover:bg-blue-700 text-white'\r\n                  }`}\r\n                >\r\n                  {product.stock === 0 ? 'Out of Stock' : 'Add to Cart'}\r\n                </button>\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.preventDefault();\r\n                    handleDeleteProduct(product._id);\r\n                  }}\r\n                  className=\"flex-1 bg-red-600 text-white py-2 rounded-lg hover:bg-red-700 transition-colors text-sm\"\r\n                >\r\n                  Delete\r\n                </button>\r\n              </div>\r\n              {cart[product._id] > 0 && (\r\n                <p className=\"text-center mt-2 text-xs text-green-600 dark:text-green-400\">\r\n                  {cart[product._id]} in cart\r\n                </p>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}