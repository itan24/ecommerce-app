{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://D%3A/Programming/NodeJs%20Learning/ecommerce-app/app/add-product/page.js"],"sourcesContent":["'use client';\r\nimport { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useRouter } from 'next/navigation';\r\nimport Image from 'next/image'; // Add next/image for previews\r\n\r\nexport default function AddProduct() {\r\n  const [name, setName] = useState('');\r\n  const [price, setPrice] = useState('');\r\n  const [stock, setStock] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const [images, setImages] = useState([]);\r\n  const [previews, setPreviews] = useState([]);\r\n  const [prominentImageIndex, setProminentImageIndex] = useState(0);\r\n  const [message, setMessage] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const router = useRouter();\r\n\r\n  const handleImageChange = (e) => {\r\n    const files = Array.from(e.target.files).slice(0, 5 - images.length);\r\n    setImages(files);\r\n    const newPreviews = files.map(file => URL.createObjectURL(file));\r\n    setPreviews(newPreviews);\r\n  };\r\n\r\n  const handleDeleteImage = (index) => {\r\n    const updatedImages = images.filter((_, i) => i !== index);\r\n    const updatedPreviews = previews.filter((_, i) => i !== index);\r\n    setImages(updatedImages);\r\n    setPreviews(updatedPreviews);\r\n    if (prominentImageIndex === index) {\r\n      setProminentImageIndex(0);\r\n    } else if (prominentImageIndex > index) {\r\n      setProminentImageIndex(prominentImageIndex - 1);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    if (!name || !price || !stock || !description) {\r\n      setMessage('Please fill in all fields');\r\n      return;\r\n    }\r\n    if (price <= 0 || stock < 0) {\r\n      setMessage('Price must be greater than 0 and stock cannot be negative');\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const token = localStorage.getItem('token');\r\n      if (!token) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n\r\n      const formData = new FormData();\r\n      formData.append('name', name);\r\n      formData.append('price', price);\r\n      formData.append('stock', stock);\r\n      formData.append('description', description);\r\n      formData.append('prominentImageIndex', prominentImageIndex);\r\n      images.forEach(file => formData.append('images', file));\r\n\r\n      const res = await axios.post('/api/products', formData, {\r\n        headers: {\r\n          Authorization: token,\r\n          'Content-Type': 'multipart/form-data'\r\n        }\r\n      });\r\n\r\n      setMessage('Product added successfully! Redirecting...');\r\n      setTimeout(() => {\r\n        router.push('/products');\r\n      }, 1500);\r\n    } catch (err) {\r\n      console.error('Error adding product:', err);\r\n      if (err.response?.status === 401) {\r\n        router.push('/login');\r\n        return;\r\n      }\r\n      setMessage(err.response?.data || 'Failed to add product.');\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto mt-10 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md\">\r\n      <h2 className=\"text-2xl font-bold mb-6 text-center text-gray-800 dark:text-white\">Add New Product</h2>\r\n      <form onSubmit={handleSubmit} className=\"space-y-6\">\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Product Images</label>\r\n          <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\r\n            {previews.map((preview, index) => (\r\n              <div key={index} className=\"relative\">\r\n                <Image\r\n                  src={preview}\r\n                  alt={`Product image ${index + 1}`}\r\n                  width={128} // Match h-32 (128px)\r\n                  height={128}\r\n                  className={`w-full h-32 object-cover rounded-lg ${\r\n                    prominentImageIndex === index ? 'ring-2 ring-blue-500' : ''\r\n                  }`}\r\n                  onClick={() => setProminentImageIndex(index)}\r\n                />\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => handleDeleteImage(index)}\r\n                  className=\"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600\"\r\n                >\r\n                  <svg className=\"h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n                  </svg>\r\n                </button>\r\n              </div>\r\n            ))}\r\n            {images.length < 5 && (\r\n              <div className=\"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg flex items-center justify-center h-32\">\r\n                <label className=\"cursor-pointer\">\r\n                  <input\r\n                    type=\"file\"\r\n                    className=\"hidden\"\r\n                    accept=\"image/*\"\r\n                    multiple\r\n                    onChange={handleImageChange}\r\n                  />\r\n                  <svg className=\"h-8 w-8 text-gray-400\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\r\n                    <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 6v6m0 0v6m0-6h6m-6 0H6\" />\r\n                  </svg>\r\n                </label>\r\n              </div>\r\n            )}\r\n          </div>\r\n          <p className=\"mt-2 text-sm text-gray-500 dark:text-gray-400\">\r\n            Click an image to set it as prominent. Max 5 images.\r\n          </p>\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Product Name</label>\r\n          <input\r\n            type=\"text\"\r\n            placeholder=\"Enter product name\"\r\n            value={name}\r\n            onChange={(e) => setName(e.target.value)}\r\n            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n            required\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Description</label>\r\n          <textarea\r\n            placeholder=\"Enter product description\"\r\n            value={description}\r\n            onChange={(e) => setDescription(e.target.value)}\r\n            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n            required\r\n            rows=\"4\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Price ($)</label>\r\n          <input\r\n            type=\"number\"\r\n            placeholder=\"Enter price\"\r\n            value={price}\r\n            onChange={(e) => setPrice(e.target.value)}\r\n            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n            required\r\n            min=\"0.01\"\r\n            step=\"0.01\"\r\n          />\r\n        </div>\r\n        <div>\r\n          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Stock Quantity</label>\r\n          <input\r\n            type=\"number\"\r\n            placeholder=\"Enter stock quantity\"\r\n            value={stock}\r\n            onChange={(e) => setStock(e.target.value)}\r\n            className=\"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:border-gray-600 dark:text-white\"\r\n            required\r\n            min=\"0\"\r\n          />\r\n        </div>\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isLoading}\r\n          className=\"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        >\r\n          {isLoading ? (\r\n            <span className=\"flex items-center justify-center\">\r\n              <svg className=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n              </svg>\r\n              Adding Product...\r\n            </span>\r\n          ) : (\r\n            'Add Product'\r\n          )}\r\n        </button>\r\n      </form>\r\n      {message && (\r\n        <div className={`mt-4 p-4 rounded-lg ${\r\n          message.includes('successful') \r\n            ? 'bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-400' \r\n            : 'bg-red-50 dark:bg-red-900/20 text-red-800 dark:text-red-400'\r\n        }`}>\r\n          {message}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}